import{j as e,r as f}from"./iframe-CbZ9RuD1.js";import{C as O}from"./Heading-BBK5GD02.js";import{u as U,Q as J}from"./useQuery-1gHWNmmy.js";import{u as H}from"./useToast-YXabfrDf.js";import{B as $,g as E}from"./index-vMKhJVm3.js";import{L as z}from"./LoadingPage-BNusrsIT.js";import{A as G}from"./Alert-DSW6oEjQ.js";import{J as q}from"./JSONViewer-DaA7J4vW.js";import{D as b}from"./Divider-DGCuNmkS.js";import{K as i}from"./KeyValueRow-Bd2QL3OX.js";import{F as a}from"./Field-CSa0GJHY.js";import{f as g}from"./text-formatters-hhISWS8n.js";import{K as X}from"./KeyValueWrapper-p5ZbVku4.js";import{C as Y}from"./checkbox-Dm_TBBEE.js";import{S as s}from"./rucio-BBdC5vD1.js";import{B as Z}from"./Badge-ClFuoEMl.js";import{N as y}from"./NullBadge-dlHFD71l.js";import{T as ee}from"./ToastedTemplate-BGCvPkR0.js";import{f as te}from"./table-fixtures-VRmzXp_h.js";import{Q as se,g as _}from"./single-handlers-XctvBmPm.js";import"./preload-helper-Dp1pzeXC.js";import"./utils-DsKtx5Xo.js";import"./tw-merge-Ds6tgvmq.js";import"./index-DSpI4bVK.js";import"./list-toasts-CqaY5F_J.js";import"./index.esm-Bh9o6rCW.js";import"./iconBase-BDSQWw1B.js";import"./PageContainer-BuffACpx.js";import"./RucioLogo-je1npqWy.js";import"./LoadingSpinner-DNn-SVom.js";import"./proxy-vEXAzVUV.js";import"./use-reduced-motion-CgJySeb8.js";import"./github-DHfBN4si.js";import"./index.esm-CDVKQKGR.js";import"./index--6AZhPao.js";import"./index-YEY9OEgd.js";import"./index-BVAf5DAB.js";import"./index-_REj2qAT.js";import"./index-Dwd-kS-d.js";import"./Combination-C2wgG2I7.js";import"./index-CI9TgWTM.js";import"./XMarkIcon-Co96hGar.js";import"./index-jI6H8jZ4.js";import"./index-CzukIY3d.js";import"./Toaster-CU-bfwMZ.js";import"./index-B5AF9blO.js";const k=({meta:t})=>e.jsx(q,{value:t.filter,mode:"interactive",expandDepth:2,showCopyButton:!0,maxHeight:"100%",showExpandButton:!0,expandTitle:"Subscription Filter",className:"h-full"});k.__docgenInfo={description:`View component for displaying subscription filter JSON.
Follows the same pattern as DID details views with tabs.`,methods:[],displayName:"DetailsSubscriptionFilter",props:{account:{required:!0,tsType:{name:"string"},description:""},name:{required:!0,tsType:{name:"string"},description:""},meta:{required:!0,tsType:{name:"SubscriptionViewModel"},description:""}}};const F=({meta:t})=>e.jsx(q,{value:t.replication_rules,mode:"interactive",expandDepth:2,showCopyButton:!0,maxHeight:"100%",showExpandButton:!0,expandTitle:"Replication Rules",className:"h-full"});F.__docgenInfo={description:`View component for displaying subscription replication rules JSON.
Follows the same pattern as DID details views with tabs.`,methods:[],displayName:"DetailsSubscriptionRules",props:{account:{required:!0,tsType:{name:"string"},description:""},name:{required:!0,tsType:{name:"string"},description:""},meta:{required:!0,tsType:{name:"SubscriptionViewModel"},description:""}}};const L=({account:t,name:r,meta:n})=>e.jsxs("div",{className:"grid grid-cols-12 gap-6",children:[e.jsx("section",{className:"col-span-12 lg:col-span-5",children:e.jsxs("div",{className:"bg-neutral-100 dark:bg-neutral-800 rounded-lg shadow p-6 flex flex-col h-[calc(100vh-28rem)]",children:[e.jsx("h3",{className:"text-2xl font-semibold text-neutral-800 dark:text-neutral-200 mb-4",children:"Filter"}),e.jsx("div",{className:"flex-1 min-h-0",children:e.jsx(k,{account:t,name:r,meta:n})})]})}),e.jsx("section",{className:"col-span-12 lg:col-span-7",children:e.jsxs("div",{className:"bg-neutral-100 dark:bg-neutral-800 rounded-lg shadow p-6 flex flex-col h-[calc(100vh-28rem)]",children:[e.jsx("h3",{className:"text-2xl font-semibold text-neutral-800 dark:text-neutral-200 mb-4",children:"Replication Rules"}),e.jsx("div",{className:"flex-1 min-h-0",children:e.jsx(F,{account:t,name:r,meta:n})})]})})]});L.__docgenInfo={description:"",methods:[],displayName:"DetailsSubscriptionSections",props:{account:{required:!0,tsType:{name:"string"},description:""},name:{required:!0,tsType:{name:"string"},description:""},meta:{required:!0,tsType:{name:"SubscriptionViewModel"},description:""}}};const re={[s.ACTIVE]:"Active",[s.INACTIVE]:"Inactive",[s.NEW]:"New",[s.UPDATED]:"Updated",[s.BROKEN]:"Broken",[s.UNKNOWN]:"Unknown"},ie={[s.UPDATED]:"success",[s.ACTIVE]:"info",[s.NEW]:"info",[s.INACTIVE]:"neutral",[s.BROKEN]:"error",[s.UNKNOWN]:"neutral"},V=t=>e.jsx(Z,{value:re[t.value],variant:ie[t.value],className:t.className});V.__docgenInfo={description:"",methods:[],displayName:"SubscriptionStateBadge",props:{value:{required:!0,tsType:{name:"SubscriptionState"},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};const N=()=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-full lg:hidden",children:e.jsx(b,{})}),e.jsx("div",{className:"hidden lg:block h-auto",children:e.jsx(b,{orientation:"vertical",spacing:"md"})})]}),I=({meta:t})=>{const r=()=>t.lifetime&&t.lifetime!==""?e.jsx(a,{children:t.lifetime}):e.jsx(y,{}),n=()=>t.last_processed&&t.last_processed!==""?e.jsx(a,{children:g(t.last_processed)}):e.jsx(y,{});return e.jsx("div",{className:"w-full",children:e.jsx(X,{className:"flex 2xl:flex-row flex-col p-6",children:e.jsxs("div",{className:"flex lg:flex-row flex-col lg:justify-between grow",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx(i,{name:"Name",children:e.jsx(a,{children:t.name})}),e.jsx(i,{name:"Account",children:e.jsx(a,{children:t.account})}),e.jsx(i,{name:"State",children:e.jsx(V,{value:t.state})}),e.jsx(i,{name:"ID",children:e.jsx(a,{className:"font-mono text-sm",children:t.id})})]}),e.jsx(N,{}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx(i,{name:"Created At",children:e.jsx(a,{children:g(t.created_at)})}),e.jsx(i,{name:"Updated At",children:e.jsx(a,{children:g(t.updated_at)})}),e.jsx(i,{name:"Last Processed",children:n()}),e.jsx(i,{name:"Lifetime",children:r()})]}),e.jsx(N,{}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx(i,{name:"Policy ID",children:e.jsx(a,{children:t.policyid})}),e.jsx(i,{name:"Retroactive",children:e.jsx(Y,{checked:t.retroactive,disabled:!0})})]})]})})})};I.__docgenInfo={description:"",methods:[],displayName:"DetailsSubscriptionMeta",props:{meta:{required:!0,tsType:{name:"SubscriptionViewModel"},description:""}}};const h=({account:t,name:r})=>{const{toast:n}=H(),u=new $(n),[M,m]=f.useState(null),P=async()=>{const W="/api/feature/get-subscription?"+new URLSearchParams({account:t,name:r});m(null);const d=await fetch(W);if(!d.ok){let p=d.statusText;try{const x=await d.json();p=x.message||x.error||p}catch{}throw m(p),new Error(p)}const j=await d.json();return u.isValid(j)?j:null},A=["subscription-meta",t,r],{data:c,error:Q,isFetching:R,refetch:K}=U({queryKey:A,queryFn:P,retry:!1,refetchOnWindowFocus:!1});return Q?e.jsx("main",{className:"min-h-screen bg-neutral-0 dark:bg-neutral-900 transition-colors duration-200",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8 lg:py-10",children:e.jsx(G,{variant:"error",message:`Failed to load subscription ${t}:${r}. ${M||"Please try again."}`,onClose:()=>{m(null),K()}})})}):R||c===void 0?e.jsx(z,{message:"Loading subscription details..."}):e.jsx("main",{className:"min-h-screen bg-neutral-0 dark:bg-neutral-900 transition-colors duration-200",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8 lg:py-10",children:e.jsxs("div",{className:"flex flex-col space-y-6 w-full",children:[e.jsx("header",{className:"mb-2",children:e.jsx("div",{className:"overflow-y-hidden overflow-x-auto whitespace-nowrap",children:e.jsx(O,{text:c.account+":"+c.name})})}),e.jsx(I,{meta:c}),e.jsx(L,{account:t,name:r,meta:c})]})})})};h.__docgenInfo={description:"",methods:[],displayName:"DetailsSubscription",props:{account:{required:!0,tsType:{name:"string"},description:""},name:{required:!0,tsType:{name:"string"},description:""}}};const Ye={title:"Components/Pages/Subscription/Details",component:h,parameters:{docs:{disable:!0}}},B=t=>{const r=new se,[n,u]=f.useState(!0);return f.useEffect(()=>{setTimeout(()=>{u(!1)},500)},[]),n?e.jsx("div",{children:"Loading the mocking engine..."}):e.jsx(J,{client:r,children:e.jsx(ee,{children:e.jsx(h,{...t})})})},o=B.bind({});o.args={account:"jdoe",name:"test.subscription"};o.decorators=[E([_("/api/feature/get-subscription",{getData:()=>te()})])];const l=B.bind({});l.args={account:"jdoe",name:"test.subscription"};l.decorators=[E([_("/api/feature/get-subscription",{getData:()=>({status:"error",message:"Failed to load subscription"})})])];var v,S,w;o.parameters={...o.parameters,docs:{...(v=o.parameters)==null?void 0:v.docs,source:{originalSource:`args => {
  const queryClient = new QueryClient();
  const [loading, setLoading] = useState(true);

  // Wait for the mocking to be enabled
  useEffect(() => {
    setTimeout(() => {
      setLoading(false);
    }, 500);
  }, []);
  if (loading) {
    return <div>Loading the mocking engine...</div>;
  }
  return <QueryClientProvider client={queryClient}>
            <ToastedTemplate>
                <DetailsSubscription {...args} />
            </ToastedTemplate>
        </QueryClientProvider>;
}`,...(w=(S=o.parameters)==null?void 0:S.docs)==null?void 0:w.source}}};var T,D,C;l.parameters={...l.parameters,docs:{...(T=l.parameters)==null?void 0:T.docs,source:{originalSource:`args => {
  const queryClient = new QueryClient();
  const [loading, setLoading] = useState(true);

  // Wait for the mocking to be enabled
  useEffect(() => {
    setTimeout(() => {
      setLoading(false);
    }, 500);
  }, []);
  if (loading) {
    return <div>Loading the mocking engine...</div>;
  }
  return <QueryClientProvider client={queryClient}>
            <ToastedTemplate>
                <DetailsSubscription {...args} />
            </ToastedTemplate>
        </QueryClientProvider>;
}`,...(C=(D=l.parameters)==null?void 0:D.docs)==null?void 0:C.source}}};const Ze=["SubscriptionDetails","SubscriptionDetailsError"];export{o as SubscriptionDetails,l as SubscriptionDetailsError,Ze as __namedExportsOrder,Ye as default};
